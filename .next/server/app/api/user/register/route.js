"use strict";(()=>{var e={};e.id=355,e.ids=[355],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1270:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>m,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>c,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{POST:()=>u});var s=t(9303),a=t(8716),n=t(670),i=t(7070);async function u(e){try{let{telegramId:r,username:t,nickname:o,referralCode:s,country:a}=await e.json(),n=1;if(s&&"MASTER"!==s){let{data:e}=await Object(function(){var e=Error("Cannot find module '@/lib/supabase'");throw e.code="MODULE_NOT_FOUND",e}()).from("User").select("id").eq("referralCode",s).single();e&&(n=e.id)}let u=o.toUpperCase().slice(0,10),d=`pending_${r}_${Date.now()}`,{data:p,error:l}=await Object(function(){var e=Error("Cannot find module '@/lib/supabase'");throw e.code="MODULE_NOT_FOUND",e}()).from("User").insert({telegramId:r.toString(),telegramUsername:t,nickname:o,referrerId:n,referralCode:u,isPremium:!0,accountCreatedDate:new Date().toISOString(),tonWallet:d,role:"USER",isVerified:!0}).select().single();if(l)return console.error("Registration error:",l),i.NextResponse.json({error:l.message},{status:400});return i.NextResponse.json({success:!0,user:p})}catch(e){return console.error("Registration error:",e),i.NextResponse.json({error:"Registration failed"},{status:500})}}!function(){var e=Error("Cannot find module '@/lib/supabase'");throw e.code="MODULE_NOT_FOUND",e}();let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/user/register/route",pathname:"/api/user/register",filename:"route",bundlePath:"app/api/user/register/route"},resolvedPagePath:"/Users/stanislavozarchuk/Projects/matrix-ton/frontend/app/api/user/register/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:c}=d,g="/api/user/register/route";function m(){return(0,n.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:l})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(1270));module.exports=o})();